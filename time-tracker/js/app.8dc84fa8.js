(function(t){function e(e){for(var s,o,r=e[0],l=e[1],c=e[2],d=0,f=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,r=1;r<n.length;r++){var l=n[r];0!==i[l]&&(s=!1)}s&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},i={app:0},a=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0592":function(t,e,n){},1136:function(t,e,n){},2395:function(t,e,n){},"2b12":function(t,e,n){"use strict";n("3f2e")},"3f2e":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{loaded:1,dropzone:t.dropzone},attrs:{id:"time-tracker"}},[n("main",[n("div",{staticClass:"top-container"},[n("div",{staticClass:"left"},[t.mainTasks.length>0?n("button",{staticClass:"remove-all",attrs:{type:"button"},on:{click:function(e){return t.clearAll(e.clientY)}}},[n("i",{staticClass:"far fa-trash-alt"}),n("span",{staticClass:"text"},[t._v("remove all")])]):t._e()]),n("div",{staticClass:"center"},[n("input",{staticClass:"new-task",attrs:{type:"text",placeholder:"New task"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.inputTask(e.target)}}})]),n("div",{staticClass:"right"},[n("div",{staticClass:"total-duration",class:{visible:t.absoluteTotalDuration>0}},[n("i",{staticClass:"far fa-clock"}),n("span",{staticClass:"clock",domProps:{textContent:t._s(t.formatDuration(t.totalDuration,{showSeconds:t.absoluteTotalDuration<60}))}})])])]),t._l(t.mainTasks,(function(e){return n("Task",{key:e.id,attrs:{task:e},on:{"add-task":function(e){return t.addTask(e)},"remove-task-confirmation":function(e){return t.removeTaskConfirmation(e)},"reset-task":function(e){return t.resetTask(e)},"start-task":function(e){return t.startTask(e)},"stop-task":function(e){return t.stopTask(e)},"move-task":function(e){return t.moveTask(e)},"change-timeslot-begin":function(e){return t.changeTimeslotBegin(e)},"change-timeslot-end":function(e){return t.changeTimeslotEnd(e)},"remove-timeslot-confirmation":function(e){return t.removeTimeslotConfirmation(e)},"timeslot-to-new-task":function(e){return t.timeslotToNewTask(e)},"timeslot-to-task":function(e){return t.timeslotToTask(e)}}})}))],2),t.confirmation.ok?n("ConfirmDialog",{attrs:{config:t.confirmation}}):t._e()],1)},a=[],o=n("2909"),r=n("b85c"),l=(n("d81d"),n("d3b7"),n("07ac"),n("4de4"),n("7db0"),n("99af"),n("b0c0"),n("159b"),n("b64b"),n("53ca"));n("e9c4"),n("fb6a"),n("ac1f"),n("00b4"),n("4e82");function c(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n.showDays,i=void 0===s||s,a=n.showHours,o=void 0===a||a,l=n.showMinutes,c=void 0===l||l,u=n.showSeconds,d=void 0===u||u,f=t<0,m=Math.abs(t),h=[{label:"d",sec:86400,show:i},{label:"h",sec:3600,show:o},{label:"m",sec:60,show:c},{label:"s",sec:1,show:d}].filter((function(t){return t.show})),v="",p=h[h.length-1],k=Object(r["a"])(h);try{for(k.s();!(e=k.n()).done;){var g=e.value,y=Math.floor(m/g.sec);m%=g.sec,(y>0||!v&&g===p)&&(v+=y+g.label)}}catch(T){k.e(T)}finally{k.f()}return(f?"-":"")+v}function u(t,e){window.localStorage&&window.localStorage.setItem(t,JSON.stringify(e))}function d(t){if(!window.localStorage)return null;try{var e=window.localStorage.getItem(t);return JSON.parse(e)}catch(n){console.error(n)}}function f(t,e){if("function"===typeof t){var n=[].slice.apply(arguments).slice(2);t.apply(e,n)}}function m(t,e){return h(t,"0",e)}function h(t,e,n){var s="".concat(t);while(s.length<n)s=e+s;return s}function v(t){var e=/^([012]?[0-9]):?([0-5][0-9])$/,n=e.exec(t);if(null==n||3!==n.length)return t&&console.warn("Invalid time string, should match RegExp ".concat(e,' but got "').concat(t,'"')),null;var s=parseInt(n[1],10),i=parseInt(n[2],10),a=new Date;return a.setHours(s),a.setMinutes(i),a.setSeconds(0,0),a.getTime()}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.showZero,s=void 0===n||n,i=e.showSeconds,a=void 0===i||i,o=e.showMinutes,r=void 0===o||o,l=e.showHours,u=void 0===l||l,d=e.showDays,f=void 0===d||d,m=Math.round(t),h=c(m,{showDays:f,showSeconds:a,showMinutes:r,showHours:u});return!s&&/^-?0[dhms]$/.test(h)?null:h}function k(t,e){if("number"!==typeof t)return null!=t&&console.warn("Timestamp should be a number, but got a ".concat(Object(l["a"])(t))),e;var n=new Date(t),s=n.getHours(),i=n.getMinutes();return m(s,2)+":"+m(i,2)}var g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task",class:{active:t.task.isActive,"active-ancestor":t.task.isActiveAncestor,dropzone:t.dropzone,dragging:t.dragging,subtask:null!=t.task.parentId,collapsed:t.collapsed}},[n("div",{staticClass:"task-head",attrs:{draggable:"true"}},[n("div",{staticClass:"left"},[t.task.isActive?t._e():n("button",{attrs:{type:"button",title:"Start"},on:{click:function(e){return t.$emit("start-task",t.task.id)}}},[n("i",{staticClass:"fas fa-play"})]),t.task.isActive?n("button",{attrs:{type:"button",title:"Stop"},on:{click:function(e){return t.$emit("stop-task",t.task.id)}}},[n("i",{staticClass:"fas fa-stop"})]):t._e(),n("button",{staticClass:"add-subtask",attrs:{type:"button",title:"Add subtask"},on:{click:function(e){return t.addSubTask()}}},[n("i",{staticClass:"fas fa-plus-circle"})]),t.task.timeslots.length||t.task.subTasks.length?n("button",{staticClass:"toggle-collapse",attrs:{type:"button",title:t.collapsed?"Expand":"Collapse"},on:{click:function(e){t.collapsed=!t.collapsed}}},[t.collapsed?n("i",{staticClass:"fas fa-caret-down"}):t._e(),t.collapsed?t._e():n("i",{staticClass:"fas fa-caret-up"})]):t._e(),n("button",{attrs:{type:"button",title:"Remove"},on:{click:function(e){return t.$emit("remove-task-confirmation",{taskId:t.task.id,posY:e.clientY})}}},[n("i",{staticClass:"fas fa-trash-alt"})])]),n("div",{staticClass:"center"},[t.editName?t._e():n("div",{staticClass:"task-name",domProps:{textContent:t._s(t.task.name)},on:{click:function(e){return t.toggleEdit()}}}),t.editName?n("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.task._source.name,expression:"task._source.name"}],staticClass:"task-name edit",attrs:{type:"text",placeholder:"Task name"},domProps:{value:t.task._source.name},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.cancelEdit()},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"escape",void 0,e.key,void 0)?null:t.cancelEdit()}],input:function(e){e.target.composing||t.$set(t.task._source,"name",e.target.value)}}}):t._e()]),n("div",{staticClass:"right"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.task.duration>0,expression:"task.duration > 0"}],staticClass:"task-duration-wrapper"},[n("span",{staticClass:"task-duration",domProps:{textContent:t._s(t.formatDuration(t.task.duration,{showZero:!1,showSeconds:t.task.duration<60}))}})])])]),t.task.timeslots.length||t.task.subTasks.length?n("div",{staticClass:"task-body"},[t.task.timeslots.length?n("div",{staticClass:"timeslots"},t._l(t.task.timeslots,(function(e){return n("Timeslot",{key:e.id,attrs:{timeslot:e,task:t.task},on:{"change-timeslot-begin":function(e){return t.$emit("change-timeslot-begin",e)},"change-timeslot-end":function(e){return t.$emit("change-timeslot-end",e)},"remove-timeslot-confirmation":function(e){return t.$emit("remove-timeslot-confirmation",e)},"timeslot-to-new-task":function(e){return t.$emit("timeslot-to-new-task",e)},"timeslot-to-task":function(e){return t.$emit("timeslot-to-task",e)}}})})),1):t._e(),t.task.subTasks.length?n("div",{staticClass:"subtasks"},t._l(t.task.subTasks,(function(e){return n("Task",{key:e.id,attrs:{task:e},on:{"add-task":function(e){return t.$emit("add-task",e)},"remove-task-confirmation":function(e){return t.$emit("remove-task-confirmation",e)},"reset-task":function(e){return t.$emit("reset-task",e)},"start-task":function(e){return t.$emit("start-task",e)},"stop-task":function(e){return t.$emit("stop-task",e)},"move-task":function(e){return t.$emit("move-task",e)},"change-timeslot-begin":function(e){return t.$emit("change-timeslot-begin",e)},"change-timeslot-end":function(e){return t.$emit("change-timeslot-end",e)},"remove-timeslot-confirmation":function(e){return t.$emit("remove-timeslot-confirmation",e)},"timeslot-to-new-task":function(e){return t.$emit("timeslot-to-new-task",e)},"timeslot-to-task":function(e){return t.$emit("timeslot-to-task",e)}}})})),1):t._e()]):t._e()])},y=[],T=(n("a9e3"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"timeslot",class:{active:t.timeslot.isActive,dragging:t.dragging},attrs:{draggable:"true"}},[n("span",{staticClass:"timeslot-controls"},[n("span",{staticClass:"timeslot-control",attrs:{title:"Move to new subtask"},on:{click:function(e){return t.$emit("timeslot-to-new-task",t.timeslot.id)}}},[n("i",{staticClass:"far fa-window-maximize"})]),n("span",{staticClass:"timeslot-control timeslot-remove",attrs:{title:"Remove"},on:{click:function(e){return t.$emit("remove-timeslot-confirmation",{timeslotId:t.timeslot.id,posY:e.clientY})}}},[n("i",{staticClass:"fas fa-trash-alt"})])]),n("span",{staticClass:"timeslot-period"},[n("span",{staticClass:"timeslot-begin"},[null==t.begin?n("span",{domProps:{textContent:t._s(t.formatTimestamp(t.timeslot.begin,"???"))},on:{click:function(e){t.begin=t.formatTimestamp(t.timeslot.begin,"???")}}}):t._e(),null!=t.begin?n("input",{directives:[{name:"model",rawName:"v-model",value:t.begin,expression:"begin"},{name:"focus",rawName:"v-focus"}],staticClass:"edit-time",attrs:{type:"text"},domProps:{value:t.begin},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeTimeslotBegin(t.begin)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"escape",void 0,e.key,void 0))return null;t.begin=null}],input:function(e){e.target.composing||(t.begin=e.target.value)}}}):t._e()]),n("span",{staticClass:"timeslot-separator"},[t._v("–")]),n("span",{staticClass:"timeslot-end"},[null==t.end?n("span",{domProps:{textContent:t._s(t.formatTimestamp(t.timeslot.end,"???"))},on:{click:function(e){t.end=t.formatTimestamp(t.timeslot.end,"???")}}}):t._e(),null!=t.end?n("input",{directives:[{name:"model",rawName:"v-model",value:t.end,expression:"end"},{name:"focus",rawName:"v-focus"}],staticClass:"edit-time",attrs:{type:"text"},domProps:{value:t.end},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeTimeslotEnd(t.end)},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"escape",void 0,e.key,void 0))return null;t.end=null}],input:function(e){e.target.composing||(t.end=e.target.value)}}}):t._e()])]),n("span",{staticClass:"timeslot-right"},[n("span",{staticClass:"timeslot-duration",domProps:{textContent:t._s(t.formatDuration(t.timeslot.duration,{showZero:!1}))}})])])}),b=[],w={name:"Timeslot",props:{timeslot:Object,task:Object},mounted:function(){this.$el.addEventListener("dragstart",this.onDragStart),this.$el.addEventListener("dragend",this.onDragEnd),document.addEventListener("click",this.onClick)},beforeDestroy:function(){this.$el.removeEventListener("dragstart",this.onDragStart),this.$el.removeEventListener("dragend",this.onDragEnd),document.removeEventListener("click",this.onClick)},data:function(){return{begin:null,end:null,dragging:!1}},methods:{formatTimestamp:k,formatDuration:p,changeTimeslotBegin:function(t){var e=this.timeslot.id,n=v(t);this.$emit("change-timeslot-begin",{timeslotId:e,timestamp:n}),this.begin=null},changeTimeslotEnd:function(t){var e=this.timeslot.id,n=v(t);this.$emit("change-timeslot-end",{timeslotId:e,timestamp:n}),this.end=null},onDragStart:function(t){var e=this;t.stopPropagation(),t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move",t.dataTransfer.setData("timeslotId",this.timeslot.id),t.dataTransfer.setData("taskId",this.timeslot.taskId),setTimeout((function(){return e.dragging=!0}))},onDragEnd:function(t){t.preventDefault(),t.stopPropagation(),this.dragging=!1},onClick:function(t){if(null!=t.target&&null!=t.target.parentNode){var e=t.target.closest(".timeslot");e!==this.$el&&(this.begin=null,this.end=null)}}}},I=w,C=(n("2b12"),n("2877")),D=Object(C["a"])(I,T,b,!1,null,null,null),x=D.exports,E={name:"Task",components:{Timeslot:x},props:{task:Object,parentId:Number},mounted:function(){var t=this,e=this.$el;e.addEventListener("dragstart",this.onDragStart),e.addEventListener("dragend",this.onDragEnd),e.addEventListener("dragover",this.onDragOver),e.addEventListener("dragleave",this.onDragLeave),e.addEventListener("drop",this.onDrop),this.task.name||(this.editName=!0),setTimeout((function(){return document.addEventListener("click",t.onClick)}))},beforeDestroy:function(){this.$el.removeEventListener("dragstart",this.onDragStart),this.$el.removeEventListener("dragend",this.onDragEnd),this.$el.removeEventListener("dragover",this.onDragOver),this.$el.removeEventListener("drop",this.onDrop),this.$el.removeEventListener("dragleave",this.onDragLeave),document.removeEventListener("click",this.onClick)},data:function(){return{dropzone:!1,dragging:!1,editName:!1,collapsed:!1}},methods:{formatTimestamp:k,formatDuration:p,addSubTask:function(){this.collapsed&&(this.collapsed=!1),this.$emit("add-task",{parentId:this.task.id})},onDragStart:function(t){var e=this;t.stopPropagation(),t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move",t.dataTransfer.setData("taskId",this.task.id),setTimeout((function(){return e.dragging=!0}))},onDragEnd:function(t){t.preventDefault(),t.stopPropagation(),this.dragging=!1},onDragOver:function(t){t.preventDefault(),t.stopPropagation(),this.dragging?t.dataTransfer.dropEffect="none":this.dropzone=!0},onDragLeave:function(t){t.preventDefault(),this.dropzone=!1},onDrop:function(t){t.preventDefault(),t.stopPropagation(),this.dropzone=!1;var e=parseInt(t.dataTransfer.getData("taskId"),10),n=parseInt(t.dataTransfer.getData("timeslotId"),10);isNaN(e)||(isNaN(n)?this.onDropTask(e):this.onDropTimeslot(n))},onDropTask:function(t){this.$emit("move-task",{taskId:t,parentId:this.task.id})},onDropTimeslot:function(t){this.$emit("timeslot-to-task",{id:t,taskId:this.task.id})},onClick:function(t){if(null!=t.target&&null!=t.target.parentNode){var e=t.target.closest(".task");e!==this.$el&&this.cancelEdit()}},toggleEdit:function(){this.editName=!this.editName},cancelEdit:function(){this.editName=!1}}},$=E,_=(n("a95a"),Object(C["a"])($,g,y,!1,null,null,null)),O=_.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"confirm-dialog-wrapper"},[n("div",{staticClass:"confirm-dialog"},[n("div",{staticClass:"text",domProps:{textContent:t._s(t.config.text)}}),n("div",{staticClass:"buttons"},[n("button",{staticClass:"cancel",attrs:{type:"button"},domProps:{textContent:t._s(t.config.cancelText)},on:{click:function(e){return t.cancel()}}}),n("button",{staticClass:"ok",attrs:{type:"button"},domProps:{textContent:t._s(t.config.okText)},on:{click:function(e){return t.ok()}}})])])])},L=[],j={name:"confirm-dialog",props:{config:Object},data:function(){return{minMarginPercentage:.02}},mounted:function(){if(this.$el.addEventListener("click",this.onClick),document.addEventListener("keyup",this.onKeyup),null!=this.config.posY){var t=this.$el.querySelector(".confirm-dialog");if(null!=t){var e,n=this.getViewport(),s=this.minMarginPercentage*n.height,i=t.getBoundingClientRect(),a=i.height+2*s<n.height;if(a){e=this.config.posY-t.clientHeight/2;var o=e+i.height;e<s?e=s:n.height-o<s&&(e=n.height-s-i.height)}else e=n.height/2-t.clientHeight/2;t.style.position="absolute",t.style.top=e+"px"}}},beforeDestroy:function(){this.$el.removeEventListener("click",this.onClick),document.removeEventListener("keyup",this.onKeyup)},methods:{ok:function(){f(this.config.ok),f(this.config.always)},cancel:function(){f(this.config.cancel),f(this.config.always)},onClick:function(t){t.preventDefault(),t.stopPropagation(),t.target===this.$el&&this.cancel()},onKeyup:function(t){27===t.keyCode&&this.cancel()},getViewport:function(){return{top:0,left:0,width:window.innerWidth,height:window.innerHeight}}}},A=j,P=(n("657f"),Object(C["a"])(A,B,L,!1,null,null,null)),N=P.exports,S=n("b047"),M=n.n(S),Y=1;s["a"].directive("focus",{inserted:function(t){return t.focus()}});var z={name:"app",components:{Task:O,ConfirmDialog:N},data:function(){var t={nextId:Y,tasksById:{},timeslotsById:{},now:Date.now(),dropzone:!1,confirmation:{ok:null,okText:null,cancel:null,cancelText:null,text:null,always:null,posY:null}},e=d("time-tracker");return null!=e&&Object.assign(t,e),t},computed:{tasks:function(){var t=this,e={},n=function n(s){if(null!=e[s.id])return e[s.id];var i=t.timeslotsByTask[s.id]||[],a=(t.tasksByParentId[s.id]||[]).map(n);return e[s.id]=Object.assign({},s,{duration:t.getTaskDuration(s),timeslots:i,subTasks:a,isActive:i.some((function(t){return t.isActive})),isActiveAncestor:a.some((function(t){return t.isActive||t.isActiveAncestor})),_source:s})};return Object.values(this.tasksById).map(n)},tasksByParentId:function(){for(var t={},e=0,n=Object.values(this.tasksById);e<n.length;e++){var s=n[e];null!=s.parentId&&(null==t[s.parentId]&&(t[s.parentId]=[]),t[s.parentId].push(s))}return t},timeslots:function(){var t=this;return Object.values(this.timeslotsById).map((function(e){var n=e.end||t.now,s=null!=e.begin&&null==e.end,i=null==e.begin?0:Math.round((n-e.begin)/1e3);return Object.assign({},e,{end:n,isActive:s,duration:i,_source:e})}))},timeslotsByTask:function(){var t,e={},n=Object(r["a"])(this.timeslots);try{for(n.s();!(t=n.n()).done;){var s=t.value;null!=s.taskId&&(null==e[s.taskId]&&(e[s.taskId]=[]),e[s.taskId].push(s))}}catch(i){n.e(i)}finally{n.f()}return e},mainTasks:function(){return this.tasks.filter((function(t){return null==t.parentId}))},activeTask:function(){return this.tasks.find((function(t){return t.isActive}))},ancestors:function(){for(var t={},e={},n=0,s=Object.values(this.tasksById);n<s.length;n++){var i=s[n];t[i.id]=this.getAncestors(i,e)}return t},totalDuration:function(){return this.mainTasks.reduce((function(t,e){return t+e.duration}),0)},absoluteTotalDuration:function(){return Math.abs(this.totalDuration)}},methods:{getAncestors:function(t,e){var n=this.tasksById[t.parentId];if(null==n)return[];if(null!=e[t.id])return e[t.id];if(null!=n){var s=[n].concat(Object(o["a"])(this.getAncestors(n,e)));return e[t.id]=s,s}},isAncestor:function(t,e){return this.ancestors[e.id].indexOf(t)>-1},save:function(){var t=this.nextId,e=this.tasksById,n=this.timeslotsById,s={nextId:t,tasksById:e,timeslotsById:n};u("time-tracker",s)},inputTask:function(t){this.addTask({name:t.value}),t.value=""},addTask:function(t){var e=t.name,n=t.parentId,s=this.createTask(e,n);this.startTask(s.id)},createTask:function(t,e){var n=this.nextId++,i={id:n,parentId:e,name:t};return s["a"].set(this.tasksById,n,i),i},moveTask:function(t){var e=t.taskId,n=t.parentId;if(null!=e&&null!=n&&e!==n){var i=this.tasksById[e],a=this.tasksById[n];if(null==i||null==a||i.parentId===a.id)return;if(this.isAncestor(i,a))return;this.updateTask(e,(function(t){return s["a"].set(t,"parentId",n),t}))}},changeTimeslotBegin:function(t){this.changeTimeslotTimestamp(t,"begin")},changeTimeslotEnd:function(t){this.changeTimeslotTimestamp(t,"end")},changeTimeslotTimestamp:function(t,e){var n=t.timeslotId,i=t.timestamp;this.updateTimeslot(n,(function(t){return s["a"].set(t,e,i),t}))},onDrop:function(t){this.dropzone=!1;var e=t.dataTransfer.getData("taskId");e&&this.updateTask(e,(function(t){return s["a"].delete(t,"parentId"),t}))},onDragOver:function(t){t.preventDefault();var e=t.dataTransfer.types.indexOf("timeslotid")>-1;e?t.dataTransfer.dropEffect="none":this.dropzone=!0},onDragLeave:function(t){t.preventDefault(),this.dropzone=!1},updateTask:function(t,e){var n=this.tasksById[t];null!=n&&e(n)},updateTimeslot:function(t,e,n){var i=this.timeslotsById[t];if(null!=i){var a=e(i);s["a"].set(this.timeslotsById,a.id,a),"function"===typeof n&&n()}else console.warn("No timeslot found with id ".concat(t))},startTask:function(t){var e=this,n=this.activeTask;n&&n.id!==t&&this.stopTask(n.id),this.updateTask(t,(function(n){return e.createTimeslot(t),n}))},stopTask:function(t){var e=this;this.updateTask(t,(function(n){if(null!=n){var i,a=e.timeslotsByTask[t]||[],o=a.filter((function(t){return t.isActive})).map((function(t){return e.timeslotsById[t.id]})),l=Date.now(),c=Object(r["a"])(o);try{for(c.s();!(i=c.n()).done;){var u=i.value;s["a"].set(u,"end",l)}}catch(d){c.e(d)}finally{c.f()}return n}}))},removeTask:function(t){if(this.tasksById[t]){s["a"].delete(this.tasksById,t);var e=this.tasksByParentId[t];if(Array.isArray(e)){var n,i=Object(r["a"])(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.removeTask(a.id)}}catch(d){i.e(d)}finally{i.f()}}var o=this.timeslotsByTask[t];if(Array.isArray(o)){var l,c=Object(r["a"])(o);try{for(c.s();!(l=c.n()).done;){var u=l.value;this.removeTimeslot(u.id)}}catch(d){c.e(d)}finally{c.f()}}0===this.tasks.length&&(this.nextId=Y)}},removeTaskConfirmation:function(t){var e=this,n=t.taskId,s=this.tasksById[n];if(null!=s){var i=s.name||"<no name>";this.showConfirmation({text:"Remove ".concat(i,"?"),ok:function(){return e.removeTask(n)},always:this.clearConfirmation,posY:t.posY})}},showConfirmation:function(t){var e=t.text,n=t.ok,s=t.always,i=t.cancel,a=t.posY,o=t.okText,r=void 0===o?"Yes":o,l=t.cancelText,c=void 0===l?"No":l;Object.assign(this.confirmation,{text:e,ok:n,always:s,cancel:i,posY:a,okText:r,cancelText:c})},clearConfirmation:function(){var t=this;Object.keys(this.confirmation).forEach((function(e){return t.confirmation[e]=null}))},createTimeslot:function(t){var e=this.nextId++;this.setNow();var n={id:e,taskId:t,begin:this.now};return s["a"].set(this.timeslotsById,e,n),n},removeTimeslot:function(t){s["a"].delete(this.timeslotsById,t)},removeTimeslotConfirmation:function(t){var e=this,n=t.timeslotId,s=this.timeslotsById[n];if(null!=s){var i=this.tasksById[s.taskId],a=i&&i.name||"<no task>",o=k(s.begin,"???"),r=k(s.end||this.now,"???");this.showConfirmation({text:"Remove ".concat(o," - ").concat(r," of ").concat(a,"?"),ok:function(){return e.removeTimeslot(n)},always:this.clearConfirmation,posY:t.posY})}},timeslotToNewTask:function(t){var e=this.timeslotsById[t];if(null!=e){var n=this.createTask(null,e.taskId);this.timeslotToTask({id:t,taskId:n.id})}},timeslotToTask:function(t){var e=t.id,n=t.taskId;null!=this.tasksById[n]&&this.updateTimeslot(e,(function(t){return s["a"].set(t,"taskId",n),t}))},clearAll:function(t){var e=this,n=function(){for(var t in e.nextId=Y,e.tasksById)s["a"].delete(e.tasksById,t);for(var n in e.timeslotsById)s["a"].delete(e.timeslotsById,n)};this.showConfirmation({text:"Remove all tasks?",ok:n,always:this.clearConfirmation,posY:t})},resetTask:function(t){var e=this;this.updateTask(t,(function(n){return e.clearTimeslots(t),n}))},clearTimeslots:function(t){var e=this.timeslotsByTask[t];if(Array.isArray(e)){var n,i=Object(r["a"])(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;s["a"].delete(this.timeslotsById,a.id)}}catch(o){i.e(o)}finally{i.f()}}},getTaskDuration:function(t){var e=this,n=this.timeslotsByTask[t.id]||[],s=n.reduce((function(t,e){return t+e.duration}),0),i=this.tasksByParentId[t.id]||[],a=i.reduce((function(t,n){return t+e.getTaskDuration(n)}),0);return s+a},updateDocumentTitle:function(){if(null==this.activeTask||0===this.activeTask.duration)document.title!==this.documentTitle&&(document.title=this.documentTitle);else{var t=p(this.activeTask.duration,{showZero:!1,showSeconds:Math.abs(this.activeTask.duration)<60});if(null!=t){var e=this.activeTask.name;document.title=e?"".concat(t," - ").concat(e):t}}},formatDuration:p,setNow:function(){this.now=Date.now()},mainLoop:function(t){var e=this;this.setNow(),this.updateDocumentTitle(),setTimeout((function(){return e.mainLoop(t)}),t)}},mounted:function(){var t=this;this.documentTitle=document.title,s["a"].nextTick((function(){return t.mainLoop(1e3)})),this.$el.addEventListener("drop",this.onDrop),this.$el.addEventListener("dragover",this.onDragOver),this.$el.addEventListener("dragleave",this.onDragLeave);var e=M()(this.save,250);this.$watch("tasksById",e,{deep:!0}),this.$watch("timeslotsById",e,{deep:!0})},beforeDestroy:function(){this.$el.removeEventListener("drop",this.onDrop),this.$el.removeEventListener("dragover",this.onDragOver),this.$el.removeEventListener("dragleave",this.onDragLeave)}},H=z,R=(n("7c55"),Object(C["a"])(H,i,a,!1,null,null,null)),J=R.exports;s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(J)}}).$mount("#app")},"657f":function(t,e,n){"use strict";n("1136")},"7c55":function(t,e,n){"use strict";n("2395")},a95a:function(t,e,n){"use strict";n("0592")}});
//# sourceMappingURL=app.8dc84fa8.js.map